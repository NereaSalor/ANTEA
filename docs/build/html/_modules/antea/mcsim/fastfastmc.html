
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>antea.mcsim.fastfastmc &#8212; antea  documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for antea.mcsim.fastfastmc</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># The fast fast MC generates pairs of interaction points based on</span>
<span class="c1">#  pre-determined matrices of true r, phi, and z coordinates vs. their</span>
<span class="c1">#  reconstructed error.</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="n">errmat</span> <span class="kn">import</span> <span class="nn">errmat</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="n">phantom</span> <span class="kn">import</span> <span class="nn">phantom</span>

<div class="viewcode-block" id="run_fastfastmc"><a class="viewcode-back" href="../../../src/code_mcsim.html#antea.mcsim.fastfastmc.run_fastfastmc">[docs]</a><span class="k">def</span> <span class="nf">run_fastfastmc</span><span class="p">(</span><span class="n">Nevts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">phtm</span><span class="p">:</span> <span class="n">phantom</span><span class="p">,</span> <span class="n">errmat_r</span><span class="p">:</span> <span class="n">errmat</span><span class="p">,</span> <span class="n">errmat_phi</span><span class="p">:</span> <span class="n">errmat</span><span class="p">,</span>
                    <span class="n">errmat_z</span><span class="p">:</span> <span class="n">errmat</span><span class="p">,</span> <span class="n">rmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">380.0</span><span class="p">,</span> <span class="n">zmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">450.0</span><span class="p">,</span>
                    <span class="n">zmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">450.0</span><span class="p">,</span> <span class="n">coslim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.309</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the fast fast MC, simulating coincident events in a PETALO geometry</span>
<span class="sd">    subject to the specified restrictions.</span>

<span class="sd">    :param Nevts: the number of events to generate</span>
<span class="sd">    :type Nevts: int</span>
<span class="sd">    :param phtm: the phantom to simulate</span>
<span class="sd">    :type phtm: class antea.mcsim.phantom</span>
<span class="sd">    :param errmat_r: the r-error matrix</span>
<span class="sd">    :type errmat_r: class antea.mcsim.errmat</span>
<span class="sd">    :param errmat_phi: the phi-error matrix</span>
<span class="sd">    :type errmat_phi: class antea.mcsim.errmat</span>
<span class="sd">    :param errmat_z: the z-error matrix</span>
<span class="sd">    :type errmat_z: class antea.mcsim.errmat</span>
<span class="sd">    :param rmin: the radius at which the LXe volume begins</span>
<span class="sd">    :type rmin: float</span>
<span class="sd">    :param zmin: minimum z-coordinate simulated (see note below)</span>
<span class="sd">    :type zmin: float</span>
<span class="sd">    :param zmax: maximum z-coordinate simulated (see note below)</span>
<span class="sd">    :type zmax: float</span>
<span class="sd">    :param coslim: limit on the cosine of the opening angle of emitted gammas</span>
<span class="sd">     (see note below)</span>
<span class="sd">    :type coslim: float</span>
<span class="sd">    :returns: dataframe containing the following information for each</span>
<span class="sd">     event: &#39;event_id&#39;, &#39;true_r1&#39;, &#39;true_phi1&#39;, &#39;true_z1&#39;, &#39;true_t1&#39;,</span>
<span class="sd">     &#39;true_r2&#39;, &#39;true_phi2&#39;, &#39;true_z2&#39;, &#39;true_t2&#39;, &#39;reco_r1&#39;, &#39;reco_phi1&#39;,</span>
<span class="sd">     &#39;reco_z1&#39;, &#39;reco_r2&#39;, &#39;reco_phi2&#39;, &#39;reco_z2&#39;</span>
<span class="sd">    :rtype: DataFrame</span>

<span class="sd">    **Note** that there are two ways to restrict the z-extent of the generated coincidences:</span>
<span class="sd">        1. direct restriction of the opening angle: this is done by specifying</span>
<span class="sd">            coslim &gt; 0. In this case the gammas emitted from each point will be</span>
<span class="sd">            restricted to opening angle with cosine from (-coslim, coslim)</span>
<span class="sd">        2. restriction of the z-extent of the gamma interactions: this is done</span>
<span class="sd">            by specifying coslim &lt; 0 and meaningful values for rmin, zmin, and</span>
<span class="sd">            zmax. In this case gammas will be generated so that they interact</span>
<span class="sd">            only within (zmin, zmax).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Pick a random number for the location of the emission point.</span>
    <span class="n">ievts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">phtm</span><span class="o">.</span><span class="n">cdist</span><span class="p">),</span><span class="n">Nevts</span><span class="p">,</span><span class="n">p</span><span class="o">=</span><span class="n">phtm</span><span class="o">.</span><span class="n">cdist</span><span class="p">)</span>

    <span class="c1"># Compute the cosines and sines of the axial angle.</span>
    <span class="n">phis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">Nevts</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">cosines_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>
    <span class="n">sines_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phis</span><span class="p">)</span>

    <span class="c1"># Set up empty arrays to contain the event information.</span>
    <span class="n">a_event_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a_true_r1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_phi1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_z1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_t1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a_true_r2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_phi2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_z2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_true_t2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a_reco_r1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_phi1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_z1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_t1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a_reco_r2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_phi2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_z2</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">a_reco_t2</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Simulate the events.</span>
    <span class="k">for</span> <span class="n">ievt</span><span class="p">,(</span><span class="n">ii</span><span class="p">,</span><span class="n">cphi</span><span class="p">,</span><span class="n">sphi</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ievts</span><span class="p">,</span><span class="n">cosines_phi</span><span class="p">,</span><span class="n">sines_phi</span><span class="p">,</span><span class="n">phis</span><span class="p">)):</span>

        <span class="c1"># Determine the point from which the gammas are emitted.</span>
        <span class="n">nnx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ii</span> <span class="o">/</span> <span class="n">phtm</span><span class="o">.</span><span class="n">NyNz</span><span class="p">)</span>
        <span class="n">nny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ii</span><span class="o">/</span><span class="n">phtm</span><span class="o">.</span><span class="n">Nz</span><span class="p">)</span> <span class="o">%</span> <span class="n">phtm</span><span class="o">.</span><span class="n">Ny</span>
        <span class="n">nnz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">%</span> <span class="n">phtm</span><span class="o">.</span><span class="n">Nz</span>

        <span class="c1"># Convert to world coordinates:</span>
        <span class="c1">#  By convention (x, y, z) = (0.0, 0.0, 0.0) cooresponds to the center</span>
        <span class="c1">#  of the modeled volume.</span>
        <span class="n">xpt</span> <span class="o">=</span> <span class="n">phtm</span><span class="o">.</span><span class="n">Lx</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nnx</span><span class="o">/</span><span class="n">phtm</span><span class="o">.</span><span class="n">Nx</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ypt</span> <span class="o">=</span> <span class="n">phtm</span><span class="o">.</span><span class="n">Ly</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nny</span><span class="o">/</span><span class="n">phtm</span><span class="o">.</span><span class="n">Ny</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">zpt</span> <span class="o">=</span> <span class="n">phtm</span><span class="o">.</span><span class="n">Lz</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nnz</span><span class="o">/</span><span class="n">phtm</span><span class="o">.</span><span class="n">Nz</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Compute the azimuthal angle.</span>
        <span class="k">if</span><span class="p">(</span><span class="n">coslim</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">clim_high</span> <span class="o">=</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">zpt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rmin</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmax</span><span class="o">-</span><span class="n">zpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">clim_low</span> <span class="o">=</span> <span class="p">(</span><span class="n">zmin</span> <span class="o">-</span> <span class="n">zpt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rmin</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">zmin</span><span class="o">-</span><span class="n">zpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">clim</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">clim_low</span><span class="p">),</span><span class="nb">abs</span><span class="p">(</span><span class="n">clim_high</span><span class="p">))</span>
            <span class="n">cth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">clim</span><span class="p">,</span><span class="n">clim</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">coslim</span><span class="p">,</span><span class="n">coslim</span><span class="p">)</span>
        <span class="n">sth</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cth</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>

        <span class="c1"># Get 2 random radii.</span>
        <span class="n">rc1</span> <span class="o">=</span> <span class="n">errmat_r</span><span class="o">.</span><span class="n">get_random_coord</span><span class="p">()</span>
        <span class="n">rc2</span> <span class="o">=</span> <span class="n">errmat_r</span><span class="o">.</span><span class="n">get_random_coord</span><span class="p">()</span>

        <span class="c1"># Determine the radii extending from the emission point for the corresponding random radii</span>
        <span class="c1">#  (which extend from the origin).  Note that these radii are in the x-y plane.</span>
        <span class="n">rpt_sq</span> <span class="o">=</span> <span class="n">xpt</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ypt</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zpt</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">xpt</span><span class="o">*</span><span class="n">cphi</span><span class="o">*</span><span class="n">sth</span> <span class="o">+</span> <span class="n">ypt</span><span class="o">*</span><span class="n">sphi</span><span class="o">*</span><span class="n">sth</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">rpt_sq</span> <span class="o">-</span> <span class="n">rc1</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">zpt</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">rp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">sth</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c1</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sth</span><span class="p">)</span>

        <span class="n">b2</span> <span class="o">=</span> <span class="o">-</span><span class="n">b1</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">rpt_sq</span> <span class="o">-</span> <span class="n">rc2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">zpt</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">rp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="n">sth</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">c2</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sth</span><span class="p">)</span>

        <span class="c1"># Compute the full radii from the emission point to each interaction point (including z).</span>
        <span class="n">rstar1</span> <span class="o">=</span> <span class="n">rp1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sth</span><span class="p">)</span>
        <span class="n">rstar2</span> <span class="o">=</span> <span class="n">rp2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sth</span><span class="p">)</span>

        <span class="c1"># Compute the two &quot;interaction points&quot;.</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">xpt</span> <span class="o">+</span> <span class="n">rstar1</span><span class="o">*</span><span class="n">cphi</span><span class="o">*</span><span class="n">sth</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">xpt</span> <span class="o">-</span> <span class="n">rstar2</span><span class="o">*</span><span class="n">cphi</span><span class="o">*</span><span class="n">sth</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">ypt</span> <span class="o">+</span> <span class="n">rstar1</span><span class="o">*</span><span class="n">sphi</span><span class="o">*</span><span class="n">sth</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">ypt</span> <span class="o">-</span> <span class="n">rstar2</span><span class="o">*</span><span class="n">sphi</span><span class="o">*</span><span class="n">sth</span>
        <span class="n">z1</span> <span class="o">=</span> <span class="n">zpt</span> <span class="o">+</span> <span class="n">rstar1</span><span class="o">*</span><span class="n">cth</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="n">zpt</span> <span class="o">-</span> <span class="n">rstar2</span><span class="o">*</span><span class="n">cth</span>

        <span class="c1"># Convert to cylindrical coordinates.</span>
        <span class="n">r1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>  <span class="c1"># This should be equal to rc1</span>
        <span class="n">phi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">phi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>

        <span class="c1"># Get all errors.</span>
        <span class="n">er1</span> <span class="o">=</span> <span class="n">errmat_r</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
        <span class="n">er2</span> <span class="o">=</span> <span class="n">errmat_r</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
        <span class="n">ephi1</span> <span class="o">=</span> <span class="n">errmat_phi</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span>
        <span class="n">ephi2</span> <span class="o">=</span> <span class="n">errmat_phi</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span>
        <span class="n">ez1</span> <span class="o">=</span> <span class="n">errmat_z</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">ez2</span> <span class="o">=</span> <span class="n">errmat_z</span><span class="o">.</span><span class="n">get_random_error</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>

        <span class="c1"># Compute reconstructed quantities.</span>
        <span class="n">r1_reco</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">-</span> <span class="n">er1</span>
        <span class="n">r2_reco</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">er2</span>
        <span class="n">phi1_reco</span> <span class="o">=</span> <span class="n">phi1</span> <span class="o">-</span> <span class="n">ephi1</span>
        <span class="n">phi2_reco</span> <span class="o">=</span> <span class="n">phi2</span> <span class="o">-</span> <span class="n">ephi2</span>
        <span class="n">z1_reco</span> <span class="o">=</span> <span class="n">z1</span> <span class="o">-</span> <span class="n">ez1</span>
        <span class="n">z2_reco</span> <span class="o">=</span> <span class="n">z2</span> <span class="o">-</span> <span class="n">ez2</span>

        <span class="c1"># Compute (in ns) the TOF.</span>
        <span class="n">tof</span> <span class="o">=</span> <span class="mf">1.0e9</span><span class="o">*</span><span class="p">(((</span><span class="n">x2</span><span class="o">-</span><span class="n">xpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">ypt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z2</span><span class="o">-</span><span class="n">zpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">-</span> <span class="p">((</span><span class="n">x1</span><span class="o">-</span><span class="n">xpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">ypt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">z1</span><span class="o">-</span><span class="n">zpt</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0e11</span>

        <span class="c1"># Add the values for this event to the arrays.</span>
        <span class="n">a_event_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ievt</span><span class="p">)</span>

        <span class="n">a_true_r1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
        <span class="n">a_true_phi1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span>
        <span class="n">a_true_t1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
        <span class="n">a_true_z1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">a_true_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
        <span class="n">a_true_phi2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span>
        <span class="n">a_true_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
        <span class="n">a_true_t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tof</span><span class="p">)</span>

        <span class="n">a_reco_r1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r1_reco</span><span class="p">)</span>
        <span class="n">a_reco_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_reco</span><span class="p">)</span>
        <span class="n">a_reco_phi1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi1_reco</span><span class="p">)</span>
        <span class="n">a_reco_phi2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi2_reco</span><span class="p">)</span>
        <span class="n">a_reco_z1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1_reco</span><span class="p">)</span>
        <span class="n">a_reco_z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z2_reco</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="n">ievt</span> <span class="o">%</span> <span class="p">(</span><span class="n">Nevts</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done </span><span class="si">{}</span><span class="s2"> events&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ievt</span><span class="p">))</span>

    <span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;event_id&#39;</span><span class="p">:</span>  <span class="n">a_event_ids</span><span class="p">,</span>
                           <span class="s1">&#39;true_r1&#39;</span><span class="p">:</span>   <span class="n">a_true_r1</span><span class="p">,</span>
                           <span class="s1">&#39;true_phi1&#39;</span><span class="p">:</span> <span class="n">a_true_phi1</span><span class="p">,</span>
                           <span class="s1">&#39;true_z1&#39;</span><span class="p">:</span>   <span class="n">a_true_z1</span><span class="p">,</span>
                           <span class="s1">&#39;true_t1&#39;</span><span class="p">:</span>   <span class="n">a_true_t1</span><span class="p">,</span>
                           <span class="s1">&#39;true_r2&#39;</span><span class="p">:</span>   <span class="n">a_true_r2</span><span class="p">,</span>
                           <span class="s1">&#39;true_phi2&#39;</span><span class="p">:</span> <span class="n">a_true_phi2</span><span class="p">,</span>
                           <span class="s1">&#39;true_z2&#39;</span><span class="p">:</span>   <span class="n">a_true_z2</span><span class="p">,</span>
                           <span class="s1">&#39;true_t2&#39;</span><span class="p">:</span>   <span class="n">a_true_t2</span><span class="p">,</span>
                           <span class="s1">&#39;reco_r1&#39;</span><span class="p">:</span>   <span class="n">a_reco_r1</span><span class="p">,</span>
                           <span class="s1">&#39;reco_phi1&#39;</span><span class="p">:</span> <span class="n">a_reco_phi1</span><span class="p">,</span>
                           <span class="s1">&#39;reco_z1&#39;</span><span class="p">:</span>   <span class="n">a_reco_z1</span><span class="p">,</span>
                           <span class="s1">&#39;reco_r2&#39;</span><span class="p">:</span>   <span class="n">a_reco_r2</span><span class="p">,</span>
                           <span class="s1">&#39;reco_phi2&#39;</span><span class="p">:</span> <span class="n">a_reco_phi2</span><span class="p">,</span>
                           <span class="s1">&#39;reco_z2&#39;</span><span class="p">:</span>   <span class="n">a_reco_z2</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">events</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">antea</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../src/code_mcsim.html">MC simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../src/code_reconstruction.html">Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../src/code_utils.html">Utilities</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
      
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>